graph TB
    subgraph PropSync["PropSync - Property Sync System"]
        Init[DOMContentLoaded Event]

        subgraph Helpers["Helper Functions"]
            FormatNum[formatNumber]
            FormatCurr[formatCurrency]
            ParseVal[parseVal]
            MarkSoldOut[markPriceContainerAsSoldOut]
            ProcessAvail[processAvailabilityWrapper]
        end

        subgraph Features["Core Features"]
            ApplyLinks[Apply Links Handler]
            FormatPrice[Format Price Elements]
            FormatSqr[Format Square Footage]
            PageTemplate[Page Template Init]
            ListFilter[List Page Filtering]
            Accordion[Accordion Functionality]
            CardComp[Card Comparisons]
        end

        subgraph Diagnostics["Diagnostic System"]
            CheckClasses["Check Required<br/>Filter Classes"]
            ValidateElements["Validate Found vs<br/>Missing Classes"]
            LogDiagnostics["Log Results if<br/>Found >= 2"]
            MissingReport["Report Missing<br/>Classes"]
        end

        subgraph FloorPlan["Floor Plan Display Logic"]
            CheckAvail[Check Price Availability]
            KeepVisible[Keep Floor Plan Visible]
            ShowSoldOut[Display 'Sold Out' Message]
            HidePriceEls[Hide Price & Starting At Elements]
        end

        subgraph AvailabilityDisplay["Availability Display Logic"]
            CheckAvailCount["Check Item Count<br/>(0, 1-9, 10+)"]
            ShowSoldOutAvail["If 0: Replace with 'Sold Out'<br/>Hide available-text"]
            Show9Plus["If >9: Replace with '9+'"]
        end

        subgraph FilterSystem["Filtering System"]
            BedroomFilter[Bedroom Filter]
            PriceSlider[Price Range Slider]
            SqrSlider[Square Footage Slider]
            ApplyBtn[Apply Button]
            ResetBtn[Reset Button]
            ResultCount[Results Counter]
            ItemsSummary["Items Summary<br/>- results-count: Total Before Filter<br/>- items-count: After Filter"]
        end

        subgraph AccordionSys["Accordion System"]
            GroupCards[Group by Bedroom Type]
            CalcMinPrice[Calculate Min Price - Exclude Sold Out]
            RenderAccordion[Render Accordion Items]
            ToggleAccordion[Toggle Accordion State]
            HideStartingPrice[Hide Starting Price if All Sold Out]
        end
    end

    Init --> Helpers
    Init --> Features

    Features --> ApplyLinks
    Features --> FormatPrice
    Features --> FormatSqr
    Features --> PageTemplate
    Features --> ListFilter
    Features --> Accordion
    Features --> CardComp

    ListFilter --> Diagnostics
    ListFilter --> FilterSystem
    ListFilter --> FloorPlan

    Diagnostics --> CheckClasses
    CheckClasses --> ValidateElements
    ValidateElements --> LogDiagnostics
    LogDiagnostics -->|Found >= 2| MissingReport
    MissingReport --> FilterSystem

    FloorPlan --> CheckAvail
    CheckAvail -->|Negative Price| KeepVisible
    KeepVisible --> HidePriceEls
    HidePriceEls --> ShowSoldOut
    CheckAvail -->|Valid Price| FormatPrice

    FilterSystem --> BedroomFilter
    FilterSystem --> PriceSlider
    FilterSystem --> SqrSlider
    ApplyBtn --> ResultCount
    ApplyBtn --> ItemsSummary
    ResetBtn --> ResultCount
    ResetBtn --> ItemsSummary

    Accordion --> AccordionSys
    AccordionSys --> GroupCards
    GroupCards --> CalcMinPrice
    CalcMinPrice --> HideStartingPrice
    HideStartingPrice --> RenderAccordion
    RenderAccordion --> ToggleAccordion
    AccordionSys --> FloorPlan

    PageTemplate --> FormatPrice
    PageTemplate --> FormatSqr
    CardComp --> FormatPrice
    CardComp --> FormatSqr
    CardComp --> AvailabilityDisplay
    ListFilter --> AvailabilityDisplay
    Accordion --> AvailabilityDisplay

    AvailabilityDisplay --> CheckAvailCount
    CheckAvailCount -->|0| ShowSoldOutAvail
    CheckAvailCount -->|>9| Show9Plus
